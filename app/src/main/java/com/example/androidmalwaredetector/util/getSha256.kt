package com.example.androidmalwaredetector.util

import java.io.File
import java.security.MessageDigest

fun getSha256(file: File): String {
    // Initialize SHA-256 hash algorithm
    val digest = MessageDigest.getInstance("SHA-256")
    // Read the file in chunks to compute the hash
    file.inputStream().use { input ->
        val buffer = ByteArray(8192)
        var read: Int
        while (input.read(buffer).also { read = it } > 0) {
            digest.update(buffer, 0, read)
        }
    }
    // Convert hash bytes to hexadecimal string
    return digest.digest().joinToString("") { "%02x".format(it) }
}

